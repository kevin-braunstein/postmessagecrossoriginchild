<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Child iFrame</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; padding: 15px; background: #e3f2fd; border-left: 5px solid #2196F3; }
        h3 { margin-top: 0; color: #0d47a1; }
        
        .step-box { background: #fff; padding: 10px; margin-bottom: 10px; border: 1px solid #bbdefb; }
        
        button { cursor: pointer; padding: 6px 12px; background: #2196F3; color: white; border: none; border-radius: 3px; }
        button:hover { background: #1976D2; }
        
        .code-output { background: #333; color: #fff; padding: 8px; font-family: monospace; font-size: 12px; margin-top: 5px; min-height: 20px; white-space: pre-wrap; }
        .highlight { color: #ffff00; font-weight: bold; }
    </style>
</head>
<body>

    <h3>Child iFrame (Different Origin)</h3>

    <div class="step-box">
        <strong>Step 3: Inspect Parent</strong>
        <p>Look at <code>parent.postMessage</code> from this origin.</p>
        <button onclick="inspectParent()">Inspect Signature</button>
        <div id="inspectOutput" class="code-output">Ready to inspect...</div>
    </div>

    <div class="step-box">
        <strong>Step 4: Send Message</strong>
        <p>Attempt to send a message to the parent.</p>
        <button onclick="sendMessage()">Send Message</button>
        <div id="sendOutput" class="code-output">Ready to send...</div>
    </div>

    <script>
        function inspectParent() {
            const out = document.getElementById('inspectOutput');
            try {
                // We convert the function to a string to see its source code
                const signature = window.parent.postMessage.toString();
                
                out.innerHTML = "Browser reports signature as:\n" + 
                                `<span class='highlight'>${signature}</span>`;
                
                if (signature.includes("native code")) {
                    out.innerHTML += "\n\n[ANALYSIS]: We see Native Code. The Parent's override is HIDDEN from us.";
                } else {
                    out.innerHTML += "\n\n[ANALYSIS]: We see custom JavaScript. The override is leaked.";
                }
            } catch(e) {
                out.innerText = "Error inspecting: " + e.message;
            }
        }

        function sendMessage() {
            const out = document.getElementById('sendOutput');
            out.innerText = "Sending message: 'Hello from Child'...";
            
            // This call crosses the origin boundary
            window.parent.postMessage("Hello from Child", "*");
            
            out.innerText += "\nMessage sent. Check Parent 'Step 5' log.";
        }
    </script>
</body>
</html>
